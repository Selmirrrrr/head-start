@using HeadStart.Client.Services.Users
@implements IDisposable
@inject UserStateContainer StateContainer

<CascadingValue Value="@StateContainer" IsFixed="false">
    @ChildContent
</CascadingValue>

@code {
    [Parameter] public RenderFragment ChildContent { get; set; } = null!;

    protected override void OnInitialized()
    {
        StateContainer.OnStateChanged += HandleStateChanged;
    }

    private void HandleStateChanged()
    {
        InvokeAsync(StateHasChanged);
    }

    public void Dispose()
    {
        StateContainer.OnStateChanged -= HandleStateChanged;
    }
}